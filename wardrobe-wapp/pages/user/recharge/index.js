"use strict";var app=getApp();Page({data:{balance:"",dictId:"",rechargeList:[]},onShareAppMessage:null,setSelected:function(e){this.data.rechargeList.forEach(function(e){e.selected=!1}),e>=0&&(this.data.rechargeList[e].selected=!0),this.setData({rechargeList:this.data.rechargeList})},getUserRechargeList:function(){var e=this;app.wxRequest("/dict/getDicts",{dictName:"RECHARGE_TYPE"},function(t){var a=t.data;1==t.code?(a.dicts[0].selected=!0,e.setData({rechargeList:a.dicts,dictId:a.dicts[0].dictId,balance:a.dicts[0].dictValue})):app.showToast("获取充值字典失败","none")},function(){app.showToast("获取充值字典错误","none")})},onShow:function(){this.getUserRechargeList()},bindRechargeTap:function(e){var t=e.currentTarget.dataset;console.log(t),this.setSelected(t.index),this.setData({balance:t.balance,dictId:t.id})},bindBalanceBlur:function(e){this.setSelected(-1),this.setData({balance:e.detail.value,dictId:""})},bindSave:function(){var e=this.data.balance,t=this.data.dictId;if(""==e||e<=0)return void wx.showModal({title:"提 示",content:"请填写正确的充值金额",showCancel:!1});app.wxRequest("/user/userRecharge",{dictId:t,price:e},function(e){if(1==e.code){var t=e.data.oid;app.wxPay(t,"/pages/user/transactions/index")}else app.showToast("创建充值订单失败","none")},function(){app.showToast("创建充值订单错误","none")})}});